<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Proforma Records</title>
  <link rel="shortcut icon" href="favicon.png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <style>
  #preloader {
    position: fixed;
    left: 0;
    top: 0;
    z-index: 999;
    width: 100%;
    height: 100%;
    overflow: visible;
    background: #fff url('img/preloader.gif') no-repeat center center;
  }
  </style>
  
  <link rel="stylesheet" media="screen" href="css/style.css">
  <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
  <script src="http://d2v52k3cl9vedd.cloudfront.net/plangular/3.0.1/plangular.min.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.3.15/angular.min.js"></script>
  <script src="js/plangular.min.js"></script>
  <script src="js/snap.svg-min.js"></script>
  <!--заглушка для fireFox -->
  <script src="js/detect.min.js"></script>
  <script>
  	var user = detect.parse(navigator.userAgent);
  	if (user.browser.family === 'Firefox') {
  	  setTimeout( 'location="firefox.html";', 0);
  	}
  </script>
</head>
<body id="gradient" ng-app="app" />
<div id="preloader"></div>
<div id="particles-js">
<hr id="top" />
<hr id="right" />
<hr id="bottom" />
<hr id="left" />
</div>
<img id="img" src="img/proforma_logo.svg" alt="" />
<img id="beta" src="img/beta.svg" alt="" />
<i class="fa fa-times"></i>
<div class="social-icons">
	<ul>
		<li><a href="https://vk.com/snimu_v_kino" target="_blank"><i class="fa fa-vk"></i></a></li>
		<li><a href="https://instagram.com/snimu_v_kino" target="_blank"><i class="fa fa-instagram"></i></a></li>
		<li><a href="https://soundcloud.com/snimuvkino" target="_blank"><i class="fa fa-soundcloud"></i></a></li>
		<li><a href="http://www.youtube.com/user/MrStrizhov/videos" target="_blank"><i class="fa fa-youtube-play"></i></a></li>
		<li><a href="http://www.vimeo.com/proformarecords" target="_blank"><i class="fa fa-vimeo-square"></i></a></li>
	</ul>
</div>
<div class="galaxy">
<div class="ellipse ellipse-6" data-action="rotate_1" data-rotate="80deg*"></div>
<div class="ellipse ellipse-5" data-action="rotate_2" data-rotate="80deg*"></div>
<div class="ellipse ellipse-4" data-action="rotate_3" data-rotate="80deg*"></div>
<div class="ellipse ellipse-3" data-action="rotate_4" data-rotate="80deg*"></div>
<div class="ellipse ellipse-2" data-action="rotate_5" data-rotate="80deg*"></div>
<div class="ellipse ellipse-1" data-action="rotate_6" data-rotate="80deg*"></div>
</div>

<div plangular="https://soundcloud.com/snimuvkino/snimu-v-kino-the-truth" class="player">
  <button ng-click="playPause()" id="play">
  </button>
    <!--<h3>{{track.user.username}}</h3>-->
    <div>
	    <progress ng-click="seek($event)" ng-value="currentTime / duration || 0">
	        {{ currentTime / duration }}
	    </progress>
	    <h2>{{track.title}}</h2>
    </div>
   </div>

<!-- scripts -->
<link rel="stylesheet" href="css/font-awesome/font-awesome.css">
<link rel="stylesheet" href="css/navigation/style.css">
<script src="particles.js"></script>
<script src="js/app.js"></script>
<script src="js/galaxy.js"></script>
<script>


// target to give background to
var $div = document.getElementById("gradient");
var d = new Date();
var h = d.getHours();
var m = d.getMinutes();
var s = d.getSeconds();
var now = h*3600 + m*60 + s;
var time = [];
for(var i=0, j=0; i<24; i++, j+=3600)
	time[i]=j;
// rgb vals of the gradients
var gradients = [
  {  start: [24,21,32], stop: [2,1,17] },
  {  start: [31,31,43], stop: [2,1,17] },
  {  start: [57,57,81], stop: [2,1,17] },
  {  start: [81,81,117], stop: [32,32,44] },
  {  start: [138,118,171], stop: [64,64,92] },
  {  start: [205,130,160], stop: [74,73,105] },
  {  start: [232,175,209], stop: [117,122,191] },
  {  start: [235,178,178], stop: [130,173,218] },
  {  start: [177,181,234], stop: [148,197,248] },
  {  start: [148,223,255], stop: [182,234,255] },
  {  start: [103,209,251], stop: [154,226,254] },
  {  start: [56,163,209], stop: [143,222,253] },
  {  start: [36,111,168], stop: [86,192,234] },
  {  start: [30,82,142], stop: [45,144,193] },
  {  start: [90,120,131], stop: [36,114,170] },
  {  start: [156,166,113], stop: [31,82,142] },
  {  start: [232,205,93], stop: [30,82,142] },
  {  start: [178,99,57], stop: [21,66,119] },
  {  start: [179,71,14], stop: [22,60,81] },
  {  start: [135,57,17], stop: [7,27,38] },
  {  start: [86,34,10], stop: [1,10,16] },
  {  start: [74,29,6], stop: [9,4,1] },
  {  start: [20,8,0], stop: [0,0,12] },
  {  start: [0,0,12], stop: [0,0,12] }
];
var currentIndex = 0; // where we are in the gradients array
var nextIndex = 1; // what index of the gradients array is next

// how long for each transition
var k = true;
for(var i=0;i<24;i++)
{
	if(now<time[i] && k)
	{
		var transition_time = (time[i] - now);
		k = false;
		break;
	}
	currentIndex++;
	nextIndex++;
}
// how many frames per second
var fps = 30;
// interal type vars
var timer; // for the setInterval
var interval_time = Math.round(1000/fps); // how often to interval
var steps_count = 0; // steps counter
var steps_total = Math.round(transition_time*fps); // total amount of steps
var rgb_steps = {
  start: [0,0,0],
  stop: [0,0,0]
}; // how much to alter each rgb value
var rgb_values = {
  start: [0,0,0],
  stop: [0,0,0]
}; // the current rgb values, gets altered by rgb steps on each interval
var prefixes = ["-webkit-","-moz-","-o-","-ms-",""]; // for looping through adding styles
var div_style = $div.style; // short cut to actually adding styles
var gradients_tested = false;
var color1, color2;

// sets next current and next index of gradients array
function set_next(num) {
  return (num + 1 < gradients.length) ? num + 1 : 0;
}

// work out how big each rgb step is
function calc_step_size(a,b) {
  return (a - b) / steps_total;
}

// populate the rgb_values and rgb_steps objects
function calc_steps() {
  for (var key in rgb_values) {
    if (rgb_values.hasOwnProperty(key)) {
      for(var i = 0; i < 23; i++) {
        rgb_values[key][i] = gradients[currentIndex][key][i];
        rgb_steps[key][i] = calc_step_size(gradients[nextIndex][key][i],rgb_values[key][i]);
      }
    }
  }
}
// update current rgb vals, update DOM element with new CSS background
function updateGradient(){
  // update the current rgb vals
  for (var key in rgb_values) {
    if (rgb_values.hasOwnProperty(key)) {
      for(var i = 0; i < 23; i++) {
        rgb_values[key][i] += rgb_steps[key][i];
      }
    }
  }

  // generate CSS rgb values
  var t_color1 = "rgb("+(rgb_values.start[0] | 0)+","+(rgb_values.start[1] | 0)+","+(rgb_values.start[2] | 0)+")";
  var t_color2 = "rgb("+(rgb_values.stop[0] | 0)+","+(rgb_values.stop[1] | 0)+","+(rgb_values.stop[2] | 0)+")";

  // has anything changed on this interation
  if (t_color1 != color1 || t_color2 != color2) {

    // update cols strings
    color1 = t_color1;
    color2 = t_color2;
    // update DOM element style attribute
    div_style.backgroundImage = "-webkit-gradient(linear, top, bottom, from("+color1+"), to("+color2+"))";
    for (var i = 0; i < 4; i++) {
      div_style.backgroundImage = prefixes[i]+"linear-gradient(90deg, "+color1+", "+color2+")";
    }
  }

  // test if the browser can do CSS gradients
  if (div_style.backgroundImage.indexOf("gradient") == -1 && !gradients_tested) {
    // if not, kill the timer
    clearTimeout(timer);
  }
  
  gradients_tested = true;

  // we did another step
  steps_count++;
  // did we do too many steps?
  if (steps_count > steps_total) {
    // reset steps count
    steps_count = 0;
    // set new indexs
    currentIndex = set_next(currentIndex);
    nextIndex = set_next(nextIndex);
    // calc steps
    if(!k)
    {
    	transition_time = 3600;
    	steps_total = Math.round(transition_time*fps);
    	alert("леша молодец :)");
    }
    calc_steps();
  }
}

// initial step calc
calc_steps();
// go go go!

timer = setInterval(updateGradient,interval_time);
</script>
<script>
  var app = angular.module('app', ['plangular'])
    .config(function(plangularConfigProvider){
      plangularConfigProvider.clientId = 'aeb5b3f63ac0518f8362010439a77ca1';
    });
  
</script>
<script>
	$(document).ready(function(){
	    $("#play").click(function () {
	      $(this).toggleClass("stop");
	    });
	  });
</script>
<script>
jQuery(document).ready(function ($) {
    $(window).load(function () {
        setTimeout(function(){
            $('#preloader').fadeOut('slow', function () {
            });
        },2000);

    });  
});
</script>
</body>
</html>